{% extends "telemeta/base.html" %}
{% load i18n %}
{% load telemeta_utils %}
{% load teleforma_tags %}

{% block head_title %}{% trans "User Profile" %} : {{ usr.username }}{% endblock %}

{% block title %}
{% endblock %}

{% block content %}
  <div id="module-set-left" style="width: 25%">
  {% block modules %}

    <div class="module">
    <h3><a href="{% url teleforma-desk %}"><img src="{% url telemeta-images "module_playlist.png" %}" alt="playlists" style="vertical-align:middle" />{% trans "Courses" %}</a></h3>
    <div style="background: white;">
    <ul>
    {% block courses %}
    {% with user|user_courses as courses %}
    {% for course in courses %}
    <li><a href="{% url teleforma-course-detail course.id %}">{{ course.title}} {{ course.type }}</a></li>
    {% endfor %}
    {% endwith %}
    {% endblock courses %}
    </ul>
    </div>
    </div>

  {% endblock %}

  {% if user.is_authenticated %}
   <div class="module_action">
    <a href="{% url postman_write user.username %}" class="component_icon button" id="action_red">{% trans "Send a message" %}</a>
   </div>
  {%  endif %}

 </div>

<div class="desk_media">
<div class="course">

    <h1>{% trans "User profile" %} : {{ usr.username }}
    </h1>

    {% if user.is_authenticated and user.username == usr.username or user.is_staff %}
    <div id="password" style="float: right;">
    <a href="{% url telemeta-profile-edit usr.username %}" class="component_icon button icon_edit">{% trans "Edit" %}</a>
    <a href="{% url telemeta-password-change %}" class="component_icon button icon_login">{% trans "Change password" %}</a>
    </div>
    {%  endif %}

   <div class="course_content">

   <div class="infos" style="width: 55%">
     <dl class="listing">
      <dt>{% trans "First Name" %}</dt><dd>{{ usr.first_name }}</dd>
      <dt>{% trans "Last Name" %}</dt><dd>{{ usr.last_name }}</dd>
      <dt>{% trans "Email" %}</dt><dd>{{ usr.email }}</dd>

      <dt>{% trans "Institution" %}</dt><dd>{% if profile %}{{ profile.institution }}{% endif %}</dd>
      <dt>{% trans "Department" %}</dt><dd>{% if profile %}{{ profile.department }}{% endif %}</dd>
      <dt>{% trans "Function" %}</dt><dd>{% if profile %}{{ profile.function }}{% endif %}</dd>
      <dt>{% trans "Attachment" %}</dt><dd>{% if profile %}{{ profile.attachment }}{% endif %}</dd>
      <dt>{% trans "Address" %}</dt><dd>{% if profile %}{{ profile.address }}{% endif %}</dd>
      <dt>{% trans "Telephone" %}</dt><dd>{% if profile %}{{ profile.telephone }}{% endif %}</dd>
      <dt>{% trans "Expiration date" %}</dt><dd>{% if profile %}{{ profile.expiration_date }}{% endif %}</dd>

      <dt>{% trans "Is staff" %}</dt><dd>{{ usr.is_staff }}</dd>
      <dt>{% trans "Is superuser" %}</dt><dd>{{ usr.is_superuser }}</dd>
      <dt>{% blocktrans count user.groups.all.count as counter %}Group{% plural %}Groups{% endblocktrans %}</dt><dd>{% for group in usr.groups.all %}{{ group }} {% endfor %}</dd>
      <dt>{% trans "Last login" %}</dt><dd>{{ usr.last_login }}</dd>
      {% if user.is_authenticated and user.username == usr.username %}
      <dt>{% trans "Language" %}</dt><dd><form id="setlang" action="/i18n/setlang/" method="post">{% csrf_token %}
        <input name="next" type="hidden" value="" />
          <select name="language">
            {% for lang in LANGUAGES %}
             <option {% if lang.0 == LANGUAGE_CODE %}selected{% endif %} value="{{ lang.0 }}">{{ lang.1 }}</option>
            {% endfor %}
          </select><br /><br />
          <a href="#" class="component_icon button icon_ok"
            onclick="document.getElementById('setlang').submit(); return false;">{% trans "Apply" %}</a>
         </form>
        </dd>
      {%  endif %}
     </dl>
    </div>

  </div>

{% if user.is_staff %}
<a href="{% url teleforma-user-login usr.id %}" class="component_icon button icon_login">{% trans "Login as" %}</a>
{% endif %}

</div>
</div>
{% endblock content %}

