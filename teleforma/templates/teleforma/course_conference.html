{% extends "teleforma/course_media.html" %}
{% load telemeta_utils %}
{% load teleforma_tags %}
{% load i18n %}

{% block module-action %}
<script src="{{ STATIC_URL }}teleforma/js/application.js" type="text/javascript"></script>
{% get_telecaster as telecaster %}
{%  if telecaster %}
<script src="{{ STATIC_URL }}telecaster/js/application.js" type="text/javascript"></script>
<script type="text/javascript">

var conferenceUtils = {
    stop : function(id){
        json([id],'teleforma.conference_stop',function(){
            location.href = '{% url teleforma-desk %}';});
    }}

jQuery(window).ready(function(){
    var a = jQuery('#action_red');
    var f = conferenceUtils;
    a.unbind('click').click(function(){
        f.stop({{conference.id}});return false;});
    });

</script>
<div class="module_action">
<a href="#" class="component_icon button" id="action_red">{% trans "S T O P" %}</a>
</div>

{% endif %}
{% endblock module-action %}

{% block course %}
<div class="course_media">

<div class="course_title">{{ course.title }}{% if course.description %} - {{ course.description }}{% endif %} - {{ conference.session }} - {{ conference.professor }}
</div>

<div class="media">
{% for livestream in livestreams %}
{% if "webm" == livestream.stream_type %}
<div class="video">
<video width="640" height="360" controls autoplay preload="auto">
<!-- Hello Chrome and Firefox (and Opera?) -->
<source src="{{ livestream.url }}" type="video/webm" />
</video>
</div>

{% elif "mp3" == livestream.stream_type %}
<div class="audio">
<audio controls autoplay preload="auto">
<!-- Hello Chrome and Firefox (and Opera?) -->
<source src="{{ livestream.url }}" type="audio/mpeg" />
</audio>
</div>
{% endif %}
{% endfor %}
</div>

{% block general_info %}
<div class="course_content" id="media_infos">
<dl class="listing">
<dt>{% trans "Title" %}</dt><dd>{{ conference.course.title }}</dd>
<dt>{% trans "Session" %}</dt><dd>{{ conference.session }}</dd>
<dt>{% trans "Professor" %}</dt><dd><a href="{% url telemeta-profile-detail conference.professor.user.username %}" target="_blank">{{ conference.professor }}</a></dd>
<dt>{% trans "Room" %}</dt><dd>{{ conference.room }}</dd>
<dt>{% trans "Begin" %}</dt><dd>{{ conference.date_begin }}</dd>
<dt>{% trans "End" %}</dt><dd>{{ conference.date_end|yes_no }}</dd>
<dt>{% trans "Live" %}</dt><dd>{{ conference.streaming|yes_no }}</dd>
</dl>
</div>
{% endblock general_info %}

</div>
{% endblock course %}

{% block chat %}
<div id="module-set" style="width: 22%">

{% get_telecaster as telecaster %}
{%  if telecaster %}
<div class="module">
 <h3><img src="{{STATIC_URL}}teleforma/images/status.png" alt="status" style="vertical-align:middle" /> {% trans "Status" %}</h3>
 <div id="server_status_table_wrapper" class="status"></div>
</div>
{% endif %}


{% if room %}
{% with "Local tweeter" as title %}
{% include "teleforma/inc/chat_room.html" %}
{% endwith %}
{% endif %}

</div>

<script src="{{ STATIC_URL }}teleforma/js/application.js" type="text/javascript"></script>
{% get_telecaster as telecaster %}
{%  if telecaster %}
<script type="text/javascript">
server_status_callback();
</script>
{% endif %}

{% endblock chat %}
