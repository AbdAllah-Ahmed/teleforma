{% extends "teleforma/course_detail.html" %}
{% load telemeta_utils %}
{% load teleforma_tags %}
{% load i18n %}


{% block extra_javascript %}

{% if "video" in media.mime_type %}
<script src="{{STATIC_URL}}teleforma/video-js/video.js"></script>
<link href="{{STATIC_URL}}teleforma/video-js/video-js.css" rel="stylesheet">
{% endif %}

<script type="text/javascript">
$(document).ready(function(){
    InitChatWindow("{% url jqchat_ajax room.id %}", null);
    });
</script>

{% endblock extra_javascript %}

{% block module-action %}
{% if media.item.file %}
<div class="module_action">
<a href="{{ MEDIA_URL }}{{ media.item.file }}" class="component_icon button" id="action_red"><img src="{{STATIC_URL}}teleforma/images/download_media.png" alt="" style="vertical-align:middle" />&nbsp;{% trans "Download" %}</a>
</div>
{% endif %}
{% endblock module-action %}

{% block course %}
<div class="course_media">

<div class="course_title">
    <div style="float: right; font-size: 0.9em;">
        {% if "video" in media.mime_type %}
        <a href="{% url teleforma-media-detail media|get_audio_id %}" class="component_icon button icon_speaker">&nbsp;{% trans "Audio" %}</a>
        {% endif %}
        {% if "audio" in media.mime_type %}
        <a href="{% url teleforma-media-detail media|get_video_id %}" class="component_icon button icon_clap">&nbsp;{% trans "Video" %}</a>
        {% endif %}
    </div>

    {{ course.title }} - {{ type }}{% if media.conference %} - {% trans "Session" %} {{ media.conference.session }}{% endif %}

</div>

{% if access_error %}
  <p>{{ access_error }}</p>
  <p>{{ message }}</p>

{% else %}
<div class="media">

{% if "video" in media.mime_type %}
<div class="video">
<video width="640" height="360" controls preload="auto">
<!-- Hello Chrome and Firefox (and Opera?) -->
<source src="{{ MEDIA_URL }}{{ media.item.file }}" type="{{ media.mime_type }}" />
</video>
</div>

{% elif "audio" in media.mime_type %}
<div class="audio" style="margin-top:1em;">
<audio controls preload="auto">
<source src="{{ MEDIA_URL }}{{ media.item.file }}" type="{{ media.mime_type }}" />
</audio>
</div>
{% endif %}

</div>
{% endif %}

{% block general_info %}
<div class="course_content" id="media_infos">
<dl class="listing">
{% dl_field item "title" placeholder %}
{% if media.conference.professor %}
<dt>{% trans "Professor" %}</dt>
    <dd><a href="{% url telemeta-profile-detail media.conference.professor.user.username %}" target="_blank">{{ media.conference.professor }}</a></dd>
{% endif %}

{% if media.conference %}
<dt>{% trans "Begin date" %}</dt><dd>{{ media.conference.date_begin }}</dd>
<dt>{% trans "End date" %}</dt><dd>{{ media.conference.date_end }}</dd>
<dt>{% trans "Session" %}</dt><dd>{{ media.conference.session }}</dd>
<dt>{% trans "Room" %}</dt><dd>{{ media.conference.room }}</dd>
{% endif %}
<dt>{% trans "Date added" %}</dt><dd>{{ media.date_added }}</dd>
<dt>{% trans "Mime type" %}</dt><dd>{{ media.mime_type }}</dd>
</dl>
</div>

{% endblock general_info %}

</div>
{% endblock course %}

{% block chat %}
{% if room %}
{% with "Local tweeter" as title %}
{% include "teleforma/inc/chat_room.html" %}
{% endwith %}
{% endif %}
{% endblock chat %}